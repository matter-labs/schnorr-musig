name: CI

on:
  pull_request:
    branches:
     - '*'

jobs:
  ci:
    runs-on: self-hosted

    steps:
    - uses: actions/checkout@v2

    - name: rust-lints
      run: |
        cargo fmt -- --check
        cargo clippy --all --tests -- -D warnings

    - name: ts-lints
      run: |
        cd wasm/typescript-example
        yarn lint
        yarn fmt --check

    - name: rust-tests
      run: cargo test

    - name: ts-tests
      run: |
        cd wasm && ./build.sh
        cd typescript-exmaple && yarn test
